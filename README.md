# Rust-IME

一个基于 Rust 开发的 Linux 系统级输入法框架。通过监听底层键盘事件 (`/dev/input/event`) 并利用虚拟键盘 (uinput) 注入字符，实现与显示协议（Wayland/X11/TTY）无关的全局输入能力。

## 🚀 特点

- **底层驱动级监听**：在内核输入层拦截按键，不依赖特定桌面环境或显示协议，支持在 Wayland、X11 甚至纯终端 (TTY) 中完美运行。
- **幽灵文字 (Phantom Text)**：独创的行内实时预览模式，首选词直接显示在当前光标处，提供零延迟的沉浸式输入体验。
- **语义辅助码 (Semantic Auxiliary)**：通过汉字的英文标签进行快速过滤（例如输入 `li` 后按 `Shift+I` 即可定位到“里” Inside），大幅降低重码率。
- **极速粘贴注入**：利用系统剪贴板实现字符上屏，彻底解决 Wayland 下模拟 Unicode 按键序列产生的卡顿。
- **多语言方案**：原生支持中文拼音、日语五十音、英语及 Emoji 等多种混合输入方案。

---

## 📦 安装教程

### 1. 安装系统依赖

```bash
# Ubuntu/Debian 示例
sudo apt-get update
sudo apt-get install -y libxcb-composite0-dev libx11-dev libdbus-1-dev build-essential
```

### 2. 配置硬件访问权限 (免 sudo)

1. **加入输入设备组**：
   ```bash
   sudo usermod -aG input $USER
   ```
2. **配置 uinput 规则**：
   ```bash
   echo 'KERNEL=="uinput", GROUP="input", MODE="0660", OPTIONS+="static_node=uinput"' | sudo tee /etc/udev/rules.d/99-rust-ime-uinput.rules
   sudo udevadm control --reload-rules && sudo udevadm trigger
   ```
3. **重要**：完成上述步骤后，请**注销并重新登录**以使组权限生效。

### 3. 快速安装脚本

您可以直接运行项目根目录下的安装脚本：
```bash
chmod +x install.sh
./install.sh
```

---

## 🛠 使用教程

### 基本操作

| 快捷键 | 功能 | 说明 |
| :--- | :--- | :--- |
| **Ctrl + Space** | 切换输入法 | 开启/关闭中英文输入 |
| **Tab** | 切换候选词 | 在备选列表中循环选择 |
| **- / =** | 翻页 | 上一页 / 下一页候选词 |
| **Space** | 确认上屏 | 将首选词或选中词输入到当前位置 |
| **Shift + [A-Z]** | 语义过滤 | 按住 Shift 输入英文首字母，按标签快速筛选汉字 |

### 高级技巧：辅助码
1. 输入拼音 `li`。
2. 想要“里” (Inside)，按住 `Shift` 并输入 `i`。
3. 候选词将立即筛选出对应标签的字。

---

## 📅 待办事项 (TODO List)

### 1. 词典与定位优化
- [ ] **极致单字定位**：优化词库权重，实现绝大多数常用单字可通过“拼音 + 单个英文字母”辅助码精准定位。
- [ ] **声调支持**：引入声调输入，进一步降低拼音输入时的重码率。
- [ ] **动态词库更新**：支持用户自定义词条的自动学习与权重排序。

### 2. UI/UX 增强
- [ ] **影子文字高亮**：在未确认上屏前，为行内预览的“影子文字”添加高亮或虚线效果，以区分正式输入的文本。
- [ ] **拼音直转汉字**：支持在输入框直接输入拼音串并一键批量转换为汉字，无需逐词确认。

### 3. 高度可定制化
- [ ] **全按键自定义**：支持配置文件内任意修改快捷键映射。
- [ ] **图形界面配置 (GUI)**：开发配套的图形化设置界面，支持词库管理、按键映射及 UI 样式的可视化调整。
- [ ] **主题系统**：支持配置候选框的颜色、字体、透明度等外观属性。

---

## 许可证
MIT License
