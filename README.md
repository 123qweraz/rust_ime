# rust-IME 使用手册

这是一个专为 Linux 设计的高性能、现代化中文输入法引擎。采用 Rust 编写，深度适配 Wayland/COSMIC 桌面环境，提供极致的丝滑盲打体验。

---

## 💡 设计哲学与初衷 (Philosophy)

### 1. 为什么要做这个输入法？
拼音输入法最大的痛点在于 **“重码选择”**。即便全拼输入非常自然，但面对“里、力、理、利”等大量同音字时，选词过程极大地打断了思维流。

**rust-IME 的降维打击：**
- **英文辅码 (English Auxiliary)**：我们认为，现代开发者和重度电脑用户大脑中已经储备了大量的英文词汇。通过调用你本能的英文知识来实现**零重码盲打**。
- **示例**：你想打“泥”，只需输入 `niM`（M 代表英文单词 Mud 的首字母）。

### 2. 行业锐评 (Hot Takes)
- **对比五笔**：学习曲线极其陡峭，且容易忘记拆解规则。
- **对比双拼**：只解决了“输入快”，没解决“选词慢”。
- **结论**：**全拼 + 英文辅码 + 简拼** 才是速度与直觉的完美平衡。

---

## 🛠 核心功能特性

### 1. 四声调过滤与智能纠错 (Tones)
利用数字键快速锁定声调，消除 80% 的重码：
- `7`: 一声 (ā) | `8`: 二声 (á) | `9`: 三声 (ǎ) | `0`: 四声 (à)
- **用法**：输入 `ni9` -> 直接过滤出“你”、“拟”等三声字。
- **智能纠错**：如果你输入的拼音拼写有误，程序会优先匹配符合声调的候选词。

### 2. 汉字学习模式 (Learning Mode)
- **原理**：在输入法闲置时，在按键回显位置（通常是角落）自动轮播展示汉字及其对应的英文释义。
- **扩展性**：支持加载**日语词库**（如 N1-N5 JSON），在打字之余利用碎片时间记忆假名或单词。

### 3. 高性能二进制架构
- **0 秒启动**：基于 `memmap2` 内存映射，无论词库多大，加载均为微秒级。
- **FST 索引**：O(1) 复杂度的前缀查找，绝无卡顿。

---

## ⌨️ 默认快捷键 (Default Hotkeys)

| 快捷键 | 功能描述 |
| :--- | :--- |
| **`Caps Lock`** | 切换中 / 英文输入模式 |
| **`Ctrl + Space`** | 切换中 / 英文输入模式 (备选) |
| **`Tab`** | 候选词向下滚动 (Sliding Down) |
| **`Shift + Tab`** | 候选词向上滚动 (Sliding Up) |
| **`- / =`** | 候选词快速向上 / 向下翻页 |
| **`1 - 5`** | 直接选择当前视野内的候选词 |
| **`Ctrl + Alt + P`** | 循环切换输入预览模式 (无/拼音/汉字) |
| **`Ctrl + Alt + N`** | 开启 / 关闭桌面候选词通知 |
| **`Ctrl + Alt + S`** | 快速切换输入方案 (如 中文 <-> 日语) |
| **`Ctrl + Alt + V`** | 切换自动粘贴模式 (Ctrl+V / Shift+Ins) |
| **`Ctrl + Alt + B`** | 切换退格键编码 (Delete / Backspace) |
| **`Caps Lock + Tab`** | 发送真实的 CapsLock 信号 (大写锁定) |

---

## 💻 命令行用法 (CLI Usage)

- `rust-ime`: 默认进入后台守护模式。
- `rust-ime --stop`: 安全停止进程并清理 PID。
- `rust-ime --restart`: 快速重载配置与词库。
- `rust-ime --install`: 一键安装桌面自启动。
- `rust-ime --train <dir>`: 递归扫描目录进行 N-gram 增量学习。
- `rust-ime nihao`: 命令行即时转换拼音。

---

## 🎨 视觉与外观 (Web Dashboard)

访问 `http://localhost:8765` 享受 Apple 风格的配置体验：
- **外观调整**: 在线自定义候选窗位置、RGBA 颜色、字体大小、阴影。
- **学习设置**: 指定学习模式使用的特定字典文件（如 `kana.json`）。
- **一键编译**: 修改 JSON 词库后，点击网页按钮即可一键更新二进制索引。

---

## 🛡 运行权限与安全
1. **系统权限**：需加入 `input` 和 `uinput` 用户组。
2. **Wayland 防护**：自动屏蔽 `SIGPIPE` 信号，在不稳定合成器下依然稳健。